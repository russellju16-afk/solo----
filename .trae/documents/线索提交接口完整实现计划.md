## 实现计划

### 1. 调整 Lead 实体
- 修改 `src/modules/lead/entities/lead.entity.ts` 文件
- 将直接使用下划线命名的字段改为使用驼峰命名 + `@Column({ name: '下划线命名' })` 映射
- 调整 `interested_categories` 类型为 `simple-array`
- 调整 `product_id` 类型为 `string`
- 调整 `status` 默认值为 `new`
- 保留 `owner` 关联的同时，添加 `ownerId` 字段

### 2. 创建 CreateLeadDto
- 在 `src/modules/lead/dto/create-lead.dto.ts` 中定义 DTO
- 添加 `class-validator` 装饰器进行验证
- 确保所有必填字段都有适当的验证规则

### 3. 调整 LeadService
- 修改 `src/modules/lead/lead.service.ts` 文件
- 更新 `create` 方法，使用 `CreateLeadDto` 作为参数
- 确保创建线索时设置默认 `status` 为 `new`

### 4. 调整 LeadController
- 修改 `src/modules/lead/lead.controller.ts` 文件
- 更新 `create` 方法，使用 `CreateLeadDto` 作为参数

### 5. 优化 FeishuService
- 修改 `src/modules/feishu/feishu.service.ts` 文件
- 更新 `sendLeadNotification` 方法，确保发送包含所有关键信息的文本消息
- 添加渠道类型映射，将英文渠道类型转换为中文

### 6. 运行迁移
- 确保数据库连接正常
- 运行 TypeORM 迁移命令，创建或更新 `leads` 表

### 7. 测试
- 测试前台线索提交接口
- 测试飞书通知功能
- 测试后台线索管理接口

## 预期结果

1. 前台可以通过 `POST /api/leads` 提交线索，系统会自动验证请求数据
2. 提交成功后，线索会被保存到数据库
3. 同时，飞书群机器人会收到包含完整线索信息的通知
4. 后台可以通过相关接口管理线索

## 技术栈

- Node.js + TypeScript + NestJS
- TypeORM + MySQL
- Class-validator 用于数据验证
- Axios 用于飞书 Webhook 请求

## 实现时间

预计需要 2 小时完成所有调整和测试。
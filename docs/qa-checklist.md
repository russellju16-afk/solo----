# 质量巡检与自测清单

## 已排查的业务流程列表
- 官网：主页 / 产品列表与详情 / 案例 / 解决方案 / 新闻；留资表单（提交线索 + 飞书通知）。
- 管理后台：登录/退出（含 401 处理）；用户管理；产品/品牌/分类管理；内容管理（Banner/案例/解决方案/新闻）；线索管理（列表筛选、详情、跟进、状态、导出）；配置（飞书配置）——公司信息、操作日志接口后端未实现，当前功能不可用。
- 后端：上述所有前台/后台对应 API（全局前缀 `/api`，后台接口 `/api/admin/**`）。

## 发现并修复的问题摘要
- 模块：管理后台（线索）
  - 问题：线索详情不加载跟进记录，导致总是显示“暂无跟进”。
  - 处理：详情请求同时获取跟进列表并合并到 state。
- 模块：管理后台（登录）
  - 问题：记住密码会在浏览器存明文密码。
  - 处理：改为只缓存用户名，并清理旧的含密码缓存。
- 模块：后端/管理后台（线索）
  - 问题：列表返回结构混用 data/items，字段驼峰/下划线混用。
  - 处理：后端统一返回 `{ items, total }` 与 camelCase 字段；前端按 items/total 渲染并使用枚举映射。
- 模块：后端（线索导出）
  - 问题：导出接口原返回实体数组，前端期望文件下载。
  - 处理：导出生成 CSV，设置下载响应头，过滤敏感字段。
- 模块：后端（线索跟进）
  - 问题：跟进创建依赖请求体的操作者字段，存在被伪造风险。
  - 处理：改为使用 JWT 中的用户 ID 作为 operator，并在返回时输出 operatorName 等安全字段。

## 建议后续补充的测试用例
- 登录：正确凭证获取 token；错误凭证 401；token 过期后任意管理接口返回 401 并前端跳转登录。
- 线索：创建线索（含飞书通知分支可 mock）；列表分页/筛选返回 items/total；详情包含跟进记录；新增跟进使用当前登录用户；导出返回 CSV。
- 产品/内容：CRUD 接口鉴权校验；上下架/启用状态切换（如有）返回正确状态。
- 记住用户名：勾选时仅缓存用户名，不缓存密码；取消勾选后缓存被清理。
- 配置缺失路径：公司信息、操作日志接口请求返回 404/未实现时前端需有兜底提示（待实现后更新用例）。
